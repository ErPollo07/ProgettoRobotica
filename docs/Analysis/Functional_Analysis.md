# FUNCTIONAL ANALYSIS

## Description of the production line

## Hardware components of the production line

- Dobot conveyor belt  
- 3 robots (2 Dobot Magician, 1 Dobot Magician Lite)  
- Laser sensor (object presence detection)  
- Color sensor (block color identification)

## Description of the operational flow

1. Robot R1 picks up a block from warehouse 1 (manual warehouse feeding by the operator) and places it on the conveyor belt.  
2. The laser sensor detects the passage of the block and signals the event to robot R2.  
3. Robot R2 intercepts the moving block and places it on the color sensor.  
4. Robot R3, which monitors the color sensor, detects a change in the color and retrieves the block from the color sensor, depositing it in warehouse 2 in the section corresponding to the detected color.

## Communication with the ThingsBoard server

The ThingsBoard server will be hosted on a fourth PC (if a fourth PC cannot be used, one of the three will host the server).  
Each robot has its own PC connected, running the program to send data to the ThingsBoard server.
The server will contain the information that the robots will send, such as movement actions (completed and running), color status
and laser (whether it detects an object or not).
All information will be divided according to the robot it belongs to in order to support monitoring, analysis and calculation of KPIs (Key Performance Indicators)

## Robot telemetry

Each robot produces different type of telemetry.
However, all robot measure the duration of each movement.
This is require to keep track of mechanical wear that can produce degradation over time and slow or stop the production.

## Distribution of decision-making responsibilities
Operational decisions relating to the physical flow of the line (robot movements, management of the conveyor belt, picking and releasing of pieces, waste management based on color) are delegated to the robots and their respective local control PCs.
The backend does not make operational decisions or intervene on the behavior of the machines, but plays an information support role.
The backend limits itself to receiving, recording and making available the data and events generated by the line components, including the outcomes of decisions made at a local level.
In the event of anomalies or errors, the backend records the event and makes it visible to the monitoring systems, without activating automatic corrective actions on the robots.

### Robot specific telemetry

#### Robot 1

- Movement duration (default): time needed to perform his action

#### Robot 2

- Movement duration (default): time needed to perform his action
- Infrared sensor event: when a block has been detected passing in front of the infrared sensor.
- Infrared sensor error: if no block passes within a predefined interval, an error event is logged to indicate a possible flow interruption

#### Robot 3

- Movement duration (default): time needed to perform his action
- Color sensor event: log the color of the block arrived at destination

## Anomaly Management

- If the laser sensor does not detect any block passage within a predefined time interval, an error message is generated and sent to the control PC.

- The PC then records the error in the database in a dedicated error category.

- Anomalies are characterized based on: type of anomaly (e.g., sensor timeout, sensor error, execution error), detection timestamp, and the source that generated the anomaly (robot or sensor).

The system ensures complete monitoring of every production phase, from picking to final sorting.

## Message structure of telemetry

### Movement executed event

```json
{
  "ts": <timestamp>,
  "robot_id": <robot_identifier>,
  "time": <timeOfExecution>
}
```

### Infrared sensor event

```json
{
  "ts": <timestamp>,
  "robot_id": <robot_identifier>
}
```

### Infrared sensor error

```json
{}
```

### Color sensor event

```json
{
  "ts": <timestamp>,
  "robot_id": <robot_identifier>,
  "color": <detected_color>
}
```

Go back to the [requirement analysis](./Requirement_Analysis.md)  
Continue with the [technical analysis](./Technical_Analysis.md)

Go back to the [index](./Analysis.md)
